<!DOCTYPE html>
<html lang="en">
<head>
  <title>WikiPathways Example</title>
  <!-- Initialize a global WBK function -->
  <script src="https://cdn.rawgit.com/maxlath/wikidata-sdk/dist/dist/wikibase-sdk.min.js"></script>
  <!-- Initialize a global wdk object using the WBK object -->
  <script src="https://cdn.rawgit.com/maxlath/wikidata-sdk/dist/dist/wikidata-sdk.min.js"></script>
  <script>
    const wbk = new WBK({
      instance: 'https://query.wikidata.org/',
      sparqlEndpoint: 'https://query.wikidata.org/sparql'
    });
  </script>
</head>

<body>
  <pre id="output"></pre>
  <script>
    query = "SELECT DISTINCT ?drug ?drugLabel ?DRUGBANKID (SAMPLE(?KEGGID) AS ?KEGG) ?hasroleLabel ?BIOURL WHERE { ?drug wdt:P2175 wd:Q18556697 . ?drug wdt:P2868 ?hasrole . ?drug wdt:P715 ?DRUGBANKID . ?drug wdt:P665 ?KEGGID . bind (concat(\"http://bio2rdf.org/drugbank:DB\",?DRUGBANKID) as ?BIOURL) . SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\" . }} group by ?drug ?drugLabel ?DRUGBANKID ?hasrole ?hasroleLabel ?BIOURL";
    fetch(
      wbk.sparqlQuery(query)
    ).then( response => response.json()
    ).then( wdk.simplify.sparqlResults
    ).then(
      function (response) {
        document.getElementById('output').innerHTML =
          JSON.stringify(response, undefined, 2);
      }
    )
  </script>
</body>
</html>
